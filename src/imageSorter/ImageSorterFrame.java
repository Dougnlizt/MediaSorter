/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package imageSorter;

import java.awt.Image;
import java.awt.event.ActionEvent;
import java.awt.event.KeyEvent;
import java.io.File;
import java.io.FilenameFilter;
import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.Paths;
import java.time.Instant;
import java.time.LocalDateTime;
import java.time.ZoneId;
import java.time.format.TextStyle;
import java.util.ArrayList;
import java.util.List;
import java.util.Locale;
import javax.swing.AbstractAction;
import javax.swing.Action;
import javax.swing.ImageIcon;
import javax.swing.InputMap;
import javax.swing.JComboBox;
import javax.swing.JComponent;
import javax.swing.JFileChooser;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.KeyStroke;
import javax.swing.event.ChangeEvent;
import javax.swing.event.ChangeListener;

/**
 *
 * @author dougthompson
 */
public class ImageSorterFrame extends javax.swing.JFrame {

    /**
     * Creates new form ImageSorterFrame
     */
    public ImageSorterFrame() {
        initComponents();
        initMyComponents();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jSplitPane1 = new javax.swing.JSplitPane();
        jPanel2 = new javax.swing.JPanel();
        jButtonBrowseMoveTo = new javax.swing.JButton();
        jButtonBrowseSource = new javax.swing.JButton();
        jLabel2 = new javax.swing.JLabel();
        jCheckBoxAutoCreateDirs = new javax.swing.JCheckBox();
        jComboBoxSource = new javax.swing.JComboBox<>();
        jButtonBrowseDeleteTo = new javax.swing.JButton();
        jLabel1 = new javax.swing.JLabel();
        jComboBoxMoveToDestination = new javax.swing.JComboBox<>();
        jComboBoxDeleteToDestination = new javax.swing.JComboBox<>();
        jLabel3 = new javax.swing.JLabel();
        jPanel3 = new javax.swing.JPanel();
        jPanel1 = new javax.swing.JPanel();
        jLabelNext = new javax.swing.JLabel();
        jLabelPrevious = new javax.swing.JLabel();
        jSliderBrowsePictures = new javax.swing.JSlider();
        imageLabel = new imageSorter.ImageLabel();
        jPanel4 = new javax.swing.JPanel();
        jTextFieldFilename = new javax.swing.JTextField();
        jLabel10 = new javax.swing.JLabel();
        jLabelMonth = new javax.swing.JLabel();
        jLabelFilenameExtension = new javax.swing.JLabel();
        jLabelYear = new javax.swing.JLabel();
        jLabelXofY = new javax.swing.JLabel();
        jButtonMove = new javax.swing.JButton();
        jButton5 = new javax.swing.JButton();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

        jSplitPane1.setOrientation(javax.swing.JSplitPane.VERTICAL_SPLIT);
        jSplitPane1.setOneTouchExpandable(true);

        jButtonBrowseMoveTo.setText("...");
        jButtonBrowseMoveTo.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButtonBrowseMoveToActionPerformed(evt);
            }
        });

        jButtonBrowseSource.setText("...");
        jButtonBrowseSource.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButtonBrowseSourceActionPerformed(evt);
            }
        });

        jLabel2.setText("'Move To' Directory:");

        jCheckBoxAutoCreateDirs.setText("Auto create and organize by year\\month");
        jCheckBoxAutoCreateDirs.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jCheckBoxAutoCreateDirsActionPerformed(evt);
            }
        });

        jComboBoxSource.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "\\Volumes\\External Hard Drive\\Brandon\\MyPictures\\", "Item 2", "Item 3", "Item 4" }));
            jComboBoxSource.addActionListener(new java.awt.event.ActionListener() {
                public void actionPerformed(java.awt.event.ActionEvent evt) {
                    jComboBoxSourceActionPerformed(evt);
                }
            });

            jButtonBrowseDeleteTo.setText("...");
            jButtonBrowseDeleteTo.addActionListener(new java.awt.event.ActionListener() {
                public void actionPerformed(java.awt.event.ActionEvent evt) {
                    jButtonBrowseDeleteToActionPerformed(evt);
                }
            });

            jLabel1.setText("Source Directory:");

            jComboBoxMoveToDestination.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "\\Volumes\\External Hard Drive\\Pictures\\Brandon\\Sorted\\", "Item 2", "Item 3", "Item 4" }));
                jComboBoxMoveToDestination.addActionListener(new java.awt.event.ActionListener() {
                    public void actionPerformed(java.awt.event.ActionEvent evt) {
                        jComboBoxMoveToDestinationActionPerformed(evt);
                    }
                });

                jComboBoxDeleteToDestination.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "\\Volumes\\External Hard Drive\\Brandon\\Deleted\\", "Item 2", "Item 3", "Item 4" }));
                    jComboBoxDeleteToDestination.addActionListener(new java.awt.event.ActionListener() {
                        public void actionPerformed(java.awt.event.ActionEvent evt) {
                            jComboBoxDeleteToDestinationActionPerformed(evt);
                        }
                    });

                    jLabel3.setText("'Delete' Directory:");

                    javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
                    jPanel2.setLayout(jPanel2Layout);
                    jPanel2Layout.setHorizontalGroup(
                        jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addGroup(jPanel2Layout.createSequentialGroup()
                            .addContainerGap()
                            .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel2Layout.createSequentialGroup()
                                    .addGap(13, 13, 13)
                                    .addComponent(jLabel3)
                                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                    .addComponent(jComboBoxDeleteToDestination, 0, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                    .addComponent(jButtonBrowseDeleteTo, javax.swing.GroupLayout.PREFERRED_SIZE, 44, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel2Layout.createSequentialGroup()
                                    .addGap(17, 17, 17)
                                    .addComponent(jLabel1)
                                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                    .addComponent(jComboBoxSource, 0, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                    .addComponent(jButtonBrowseSource, javax.swing.GroupLayout.PREFERRED_SIZE, 44, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addGroup(jPanel2Layout.createSequentialGroup()
                                    .addComponent(jLabel2)
                                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                    .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                        .addGroup(jPanel2Layout.createSequentialGroup()
                                            .addGap(6, 6, 6)
                                            .addComponent(jCheckBoxAutoCreateDirs)
                                            .addGap(0, 0, Short.MAX_VALUE))
                                        .addGroup(jPanel2Layout.createSequentialGroup()
                                            .addComponent(jComboBoxMoveToDestination, 0, 432, Short.MAX_VALUE)
                                            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                            .addComponent(jButtonBrowseMoveTo, javax.swing.GroupLayout.PREFERRED_SIZE, 44, javax.swing.GroupLayout.PREFERRED_SIZE)))))
                            .addContainerGap())
                    );
                    jPanel2Layout.setVerticalGroup(
                        jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addGroup(jPanel2Layout.createSequentialGroup()
                            .addContainerGap()
                            .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                .addComponent(jLabel1)
                                .addComponent(jComboBoxSource, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(jButtonBrowseSource))
                            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                            .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                .addComponent(jLabel2)
                                .addComponent(jComboBoxMoveToDestination, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(jButtonBrowseMoveTo))
                            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                            .addComponent(jCheckBoxAutoCreateDirs)
                            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                            .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                .addComponent(jLabel3)
                                .addComponent(jComboBoxDeleteToDestination, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(jButtonBrowseDeleteTo))
                            .addContainerGap())
                    );

                    jSplitPane1.setLeftComponent(jPanel2);

                    jLabelNext.setFont(new java.awt.Font("Lucida Grande", 0, 48)); // NOI18N
                    jLabelNext.setText(">");
                    jLabelNext.addMouseListener(new java.awt.event.MouseAdapter() {
                        public void mouseClicked(java.awt.event.MouseEvent evt) {
                            jLabelNextMouseClicked(evt);
                        }
                    });

                    jLabelPrevious.setFont(new java.awt.Font("Lucida Grande", 0, 48)); // NOI18N
                    jLabelPrevious.setText("<");
                    jLabelPrevious.addMouseListener(new java.awt.event.MouseAdapter() {
                        public void mouseClicked(java.awt.event.MouseEvent evt) {
                            jLabelPreviousMouseClicked(evt);
                        }
                    });

                    jSliderBrowsePictures.setValue(6);

                    javax.swing.GroupLayout imageLabelLayout = new javax.swing.GroupLayout(imageLabel);
                    imageLabel.setLayout(imageLabelLayout);
                    imageLabelLayout.setHorizontalGroup(
                        imageLabelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addGap(0, 0, Short.MAX_VALUE)
                    );
                    imageLabelLayout.setVerticalGroup(
                        imageLabelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addGap(0, 0, Short.MAX_VALUE)
                    );

                    javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
                    jPanel1.setLayout(jPanel1Layout);
                    jPanel1Layout.setHorizontalGroup(
                        jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addGroup(jPanel1Layout.createSequentialGroup()
                            .addContainerGap()
                            .addComponent(jLabelPrevious)
                            .addGap(18, 18, 18)
                            .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                .addComponent(jSliderBrowsePictures, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                .addComponent(imageLabel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                            .addGap(18, 18, 18)
                            .addComponent(jLabelNext)
                            .addContainerGap())
                    );
                    jPanel1Layout.setVerticalGroup(
                        jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addGroup(jPanel1Layout.createSequentialGroup()
                            .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                .addGroup(jPanel1Layout.createSequentialGroup()
                                    .addContainerGap(187, Short.MAX_VALUE)
                                    .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                                        .addComponent(jLabelNext)
                                        .addComponent(jLabelPrevious))
                                    .addGap(141, 141, 141))
                                .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel1Layout.createSequentialGroup()
                                    .addComponent(imageLabel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                    .addComponent(jSliderBrowsePictures, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                            .addContainerGap())
                    );

                    jTextFieldFilename.setHorizontalAlignment(javax.swing.JTextField.TRAILING);
                    jTextFieldFilename.setText("DSC00123");

                    jLabel10.setText("Filename:");

                    jLabelMonth.setFont(new java.awt.Font("Lucida Grande", 0, 18)); // NOI18N
                    jLabelMonth.setText("November");

                    jLabelFilenameExtension.setText(".jpg");

                    jLabelYear.setFont(new java.awt.Font("Lucida Grande", 0, 18)); // NOI18N
                    jLabelYear.setText("2016");

                    jLabelXofY.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
                    jLabelXofY.setText("Image 3 of 40");

                    jButtonMove.setFont(new java.awt.Font("Lucida Grande", 0, 24)); // NOI18N
                    jButtonMove.setForeground(new java.awt.Color(0, 102, 0));
                    jButtonMove.setText("Move");
                    jButtonMove.addActionListener(new java.awt.event.ActionListener() {
                        public void actionPerformed(java.awt.event.ActionEvent evt) {
                            jButtonMoveActionPerformed(evt);
                        }
                    });

                    jButton5.setFont(new java.awt.Font("Lucida Grande", 0, 24)); // NOI18N
                    jButton5.setForeground(new java.awt.Color(255, 0, 51));
                    jButton5.setText("Delete");
                    jButton5.addActionListener(new java.awt.event.ActionListener() {
                        public void actionPerformed(java.awt.event.ActionEvent evt) {
                            jButton5ActionPerformed(evt);
                        }
                    });

                    javax.swing.GroupLayout jPanel4Layout = new javax.swing.GroupLayout(jPanel4);
                    jPanel4.setLayout(jPanel4Layout);
                    jPanel4Layout.setHorizontalGroup(
                        jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addGroup(jPanel4Layout.createSequentialGroup()
                            .addContainerGap()
                            .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                .addGroup(jPanel4Layout.createSequentialGroup()
                                    .addComponent(jLabel10)
                                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                    .addComponent(jTextFieldFilename)
                                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                    .addComponent(jLabelFilenameExtension)
                                    .addGap(72, 72, 72)
                                    .addComponent(jLabelYear)
                                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                    .addComponent(jLabelMonth))
                                .addGroup(jPanel4Layout.createSequentialGroup()
                                    .addComponent(jButtonMove)
                                    .addGap(151, 151, 151)
                                    .addComponent(jLabelXofY, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                    .addGap(141, 141, 141)
                                    .addComponent(jButton5)))
                            .addContainerGap())
                    );
                    jPanel4Layout.setVerticalGroup(
                        jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addGroup(jPanel4Layout.createSequentialGroup()
                            .addContainerGap()
                            .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                .addComponent(jLabelXofY)
                                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                    .addComponent(jButtonMove)
                                    .addComponent(jButton5)))
                            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                                .addComponent(jLabel10)
                                .addComponent(jTextFieldFilename, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(jLabelFilenameExtension)
                                .addComponent(jLabelYear)
                                .addComponent(jLabelMonth))
                            .addContainerGap())
                    );

                    javax.swing.GroupLayout jPanel3Layout = new javax.swing.GroupLayout(jPanel3);
                    jPanel3.setLayout(jPanel3Layout);
                    jPanel3Layout.setHorizontalGroup(
                        jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addGroup(jPanel3Layout.createSequentialGroup()
                            .addGap(6, 6, 6)
                            .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                .addComponent(jPanel4, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                .addComponent(jPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                            .addContainerGap())
                    );
                    jPanel3Layout.setVerticalGroup(
                        jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addGroup(jPanel3Layout.createSequentialGroup()
                            .addContainerGap()
                            .addComponent(jPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                            .addComponent(jPanel4, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addContainerGap())
                    );

                    jSplitPane1.setRightComponent(jPanel3);

                    javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
                    getContentPane().setLayout(layout);
                    layout.setHorizontalGroup(
                        layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addComponent(jSplitPane1)
                    );
                    layout.setVerticalGroup(
                        layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addComponent(jSplitPane1)
                    );

                    pack();
                }// </editor-fold>//GEN-END:initComponents

    private void jButtonBrowseSourceActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButtonBrowseSourceActionPerformed
        selectSource();
    }//GEN-LAST:event_jButtonBrowseSourceActionPerformed

    private void jButtonBrowseMoveToActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButtonBrowseMoveToActionPerformed
        selectMoveTo();
    }//GEN-LAST:event_jButtonBrowseMoveToActionPerformed

    private void jButtonBrowseDeleteToActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButtonBrowseDeleteToActionPerformed
        selectDeleteTo();
    }//GEN-LAST:event_jButtonBrowseDeleteToActionPerformed

    private void jComboBoxSourceActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jComboBoxSourceActionPerformed
        if (!initializing) {
            savePaths(selectSourceList, sourceFileName, jComboBoxSource);
            getSourceFiles();
        }

    }//GEN-LAST:event_jComboBoxSourceActionPerformed

    private void jComboBoxMoveToDestinationActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jComboBoxMoveToDestinationActionPerformed
        if (!initializing) savePaths(moveToList, moveToFileName, jComboBoxMoveToDestination);
    }//GEN-LAST:event_jComboBoxMoveToDestinationActionPerformed

    private void jComboBoxDeleteToDestinationActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jComboBoxDeleteToDestinationActionPerformed
        if (!initializing) savePaths(deleteToList, deleteToFileName, jComboBoxDeleteToDestination);
    }//GEN-LAST:event_jComboBoxDeleteToDestinationActionPerformed

    private void jCheckBoxAutoCreateDirsActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jCheckBoxAutoCreateDirsActionPerformed
        
    }//GEN-LAST:event_jCheckBoxAutoCreateDirsActionPerformed

    private void jButton5ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton5ActionPerformed
        deleteImage();
    }//GEN-LAST:event_jButton5ActionPerformed

    private void jButtonMoveActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButtonMoveActionPerformed
        moveImage();
    }//GEN-LAST:event_jButtonMoveActionPerformed

    private void jLabelPreviousMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jLabelPreviousMouseClicked
        getPreviousImage();
    }//GEN-LAST:event_jLabelPreviousMouseClicked

    private void jLabelNextMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jLabelNextMouseClicked
        getNextImage();
    }//GEN-LAST:event_jLabelNextMouseClicked

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(ImageSorterFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(ImageSorterFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(ImageSorterFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(ImageSorterFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                initializing = true;
                new ImageSorterFrame().setVisible(true);
                initializing = false;
            }
        });
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private imageSorter.ImageLabel imageLabel;
    private javax.swing.JButton jButton5;
    private javax.swing.JButton jButtonBrowseDeleteTo;
    private javax.swing.JButton jButtonBrowseMoveTo;
    private javax.swing.JButton jButtonBrowseSource;
    private javax.swing.JButton jButtonMove;
    private javax.swing.JCheckBox jCheckBoxAutoCreateDirs;
    private javax.swing.JComboBox<String> jComboBoxDeleteToDestination;
    private javax.swing.JComboBox<String> jComboBoxMoveToDestination;
    private javax.swing.JComboBox<String> jComboBoxSource;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel10;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabelFilenameExtension;
    private javax.swing.JLabel jLabelMonth;
    private javax.swing.JLabel jLabelNext;
    private javax.swing.JLabel jLabelPrevious;
    private javax.swing.JLabel jLabelXofY;
    private javax.swing.JLabel jLabelYear;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel4;
    private javax.swing.JSlider jSliderBrowsePictures;
    private javax.swing.JSplitPane jSplitPane1;
    private javax.swing.JTextField jTextFieldFilename;
    // End of variables declaration//GEN-END:variables

    private final String homeDir = System.getProperty("user.home");
    private List<Path> selectSourceList = new ArrayList<>(); 
    private final String sourceFileName = "imageSorterSourcePaths.txt";
    private List<Path> moveToList = new ArrayList<>(); 
    private final String moveToFileName = "imageSorterMoveToPaths.txt";
    private List<Path> deleteToList = new ArrayList<>(); 
    private final String deleteToFileName = "imageSorterDeleteToPaths.txt";
    private static boolean initializing = false;
    private ArrayList<Path> filesList;
    private int fileIndex;
    
    private void initMyComponents() {
        int selectedIndex = getPaths(sourceFileName, selectSourceList);
        populateComboBox(selectSourceList, jComboBoxSource, selectedIndex);
        getSourceFiles();

        selectedIndex = getPaths(moveToFileName, moveToList);
        populateComboBox(moveToList, jComboBoxMoveToDestination, selectedIndex);

        selectedIndex = getPaths(deleteToFileName, deleteToList);
        populateComboBox(deleteToList, jComboBoxDeleteToDestination, selectedIndex);
        
        ArrayList<Integer> rightActionList = new ArrayList<>();
        rightActionList.add(KeyEvent.VK_PERIOD);
        
        ArrayList<Integer> leftActionList = new ArrayList<>();
        leftActionList.add(KeyEvent.VK_COMMA);

        JPanel content = ((JPanel) this.getContentPane());
        InputMap inputMap = content.getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW);
        
        for (int i = 0; i < rightActionList.size(); i++) {
            inputMap.put(KeyStroke.getKeyStroke(rightActionList.get(i), 0), "nextImage" + i);
            content.getActionMap().put("nextImage" + i, RightAction);
        }
        
        for (int i = 0; i < leftActionList.size(); i++) {
            inputMap.put(KeyStroke.getKeyStroke(leftActionList.get(i), 0), "previousImage" + i);
            content.getActionMap().put("previousImage" + i, LeftAction);
        }
        
        inputMap = jTextFieldFilename.getInputMap(JComponent.WHEN_FOCUSED);
        ArrayList<Integer> allActionsList = new ArrayList<>();
        allActionsList.addAll(rightActionList);
        allActionsList.addAll(leftActionList);
        
        for (int i = 0; i < allActionsList.size(); i++) {
            inputMap.put(KeyStroke.getKeyStroke(allActionsList.get(i), 0), "doNothing" + i);
            jTextFieldFilename.getActionMap().put("doNothing" + i, NothingAction);
        }
        
        jSliderBrowsePictures.addChangeListener(sliderChange);
    }
    
    Action RightAction = new AbstractAction() {
        @Override
        public void actionPerformed(ActionEvent e) {
            jLabelNextMouseClicked(null);
        }
    };

    Action LeftAction = new AbstractAction() {
        @Override
        public void actionPerformed(ActionEvent e) {
            jLabelPreviousMouseClicked(null);
        }
    };

    Action NothingAction = new AbstractAction() {
        @Override
        public void actionPerformed(ActionEvent e) {
            //Do Nothing
        }
    };
    
    ChangeListener sliderChange = new ChangeListener() {
        @Override
        public void stateChanged(ChangeEvent e) {
            fileIndex = jSliderBrowsePictures.getValue() - 1;
            setImage();
        }
    };

    private void selectSource() {
        selectDir(jComboBoxSource, selectSourceList);
        savePaths(selectSourceList, sourceFileName, null);
        getSourceFiles();
    }
    
    private void getSourceFiles() {
        //Now get the files...
        FilenameFilter filter = new FilenameFilter() {
            @Override
            public boolean accept(File dir, String name) {
                String ext = FileUtilities.getExtension(new File(name));
                if (ext == null) return false;
                return "jpgjpeggifpng".contains(ext);
            }
        };
                
        filesList = FileUtilities.getDirFiles(Paths.get((String) jComboBoxSource.getSelectedItem()), false, filter);
        if (filesList.size() > 0) {
            fileIndex = 0;
            setImage();
//            jLabelXofY.setText("1 of " + filesList.size());
//            fileIndex = 0;
//            ImageIcon imageIcon = new ImageIcon(filesList.get(fileIndex).toString());
//            imageLabel.setImage(imageIcon.getImage());
            jSliderBrowsePictures.setMaximum(filesList.size());
            jSliderBrowsePictures.setMinimum(1);
            jSliderBrowsePictures.setValue(1);
        } else {
            jLabelXofY.setText("No images in this directory");
            imageLabel.setImage(null);
        }
    }
    
    private void getNextImage() {
        fileIndex ++;
        if (fileIndex < 0) fileIndex = 1;
        if (fileIndex > filesList.size() - 1) return;
        setImage();
        jSliderBrowsePictures.setValue(fileIndex + 1);
    }
    
    private void getPreviousImage() {
        fileIndex --;
        if (fileIndex > filesList.size() - 1) fileIndex = filesList.size() - 2;
        if (fileIndex < 0) return;
        setImage();
        jSliderBrowsePictures.setValue(fileIndex + 1);
    }
    
    private void setImage() {
        jLabelXofY.setText((fileIndex + 1) + " of " + filesList.size());
        Path imageFile = filesList.get(fileIndex);
        ImageIcon imageIcon = new ImageIcon(imageFile.toString());
        imageLabel.setImage(imageIcon.getImage());
        jTextFieldFilename.setText(FileUtilities.getPrefix(imageFile.getFileName().toFile()));
        jLabelFilenameExtension.setText("." + FileUtilities.getExtension(imageFile.getFileName().toFile()));
        
        long lastModified = imageFile.toFile().lastModified();
        LocalDateTime fileDateTime = LocalDateTime.ofInstant(Instant.ofEpochMilli(lastModified), ZoneId.systemDefault());
        String year = String.valueOf(fileDateTime.getYear());
        String month = fileDateTime.getMonth().getDisplayName(TextStyle.FULL, Locale.getDefault());
        jLabelYear.setText(year);
        jLabelMonth.setText(month);
    }
    
    private void selectMoveTo() {
        selectDir(jComboBoxMoveToDestination, moveToList);
        savePaths(moveToList, moveToFileName, null);
    }
    
    private void selectDeleteTo() {
        selectDir(jComboBoxDeleteToDestination, deleteToList);
        savePaths(deleteToList, deleteToFileName, null);
    }

    private void selectDir(JComboBox<String> comboBox, List<Path> comboList) {
        JFileChooser chooser = new JFileChooser();
        chooser.setFileSelectionMode(JFileChooser.DIRECTORIES_ONLY);
        String selectedSource = (String) comboBox.getSelectedItem();
        Path currPath = null;
        if (selectedSource != null) {
            currPath = Paths.get(selectedSource);
        }
        if (currPath != null) {
            chooser.setCurrentDirectory(currPath.toFile());
        }
        int returnValue = chooser.showDialog(this, "Select Dir");
        switch(returnValue) {
            case JFileChooser.CANCEL_OPTION:
                return;
            case JFileChooser.ERROR_OPTION:
                JOptionPane.showMessageDialog(this, "There was an error", "Error Selecting Directory", JOptionPane.OK_OPTION);
                return;
            case JFileChooser.APPROVE_OPTION:
                break;
        }
        File dirItem = chooser.getSelectedFile();
        Path newPath = dirItem.toPath();
        
        if (newPath != null) {
            //Add it to the list and refresh the combo box
            comboList.add(0, newPath);
            populateComboBox(comboList, comboBox, 0);
        }
    }
    
    private int getPaths(String fileName, List<Path> pathsList) {
        int selectedIndex = -10;
        try {
            ArrayList<String> directoriesList = FileUtilities.readLinesFromFile(Paths.get(homeDir, fileName));
            pathsList.clear();
            for (String pref : directoriesList) {
                if (selectedIndex == -10) {
                    try {
                        selectedIndex = Integer.parseInt(pref);
                        continue;
                    } catch (Exception ex1) {
                        //First line wasn't the index
                    }
                }
                pathsList.add(Paths.get(pref));
            }
        } catch (Exception ex2) {
            ex2.printStackTrace();
        }
        return selectedIndex;
    }
    
    private void populateComboBox(List<Path> pathList, JComboBox<String> comboBox, int selectedIndex) {        
        comboBox.removeAllItems();
        if (pathList.size() > 10) {
            pathList = pathList.subList(0, 9);
        }
        for (Path path : pathList) {
            comboBox.addItem(path.toString());
        }
        if (selectedIndex > -1 && selectedIndex < comboBox.getModel().getSize()) {
            comboBox.setSelectedIndex(selectedIndex);
        }
    }
    
    private void savePaths(List<Path> pathList, String fileName, JComboBox<String> comboBox) {
        StringBuffer stringToWrite = new StringBuffer("");
        int selectedIndex = 0;
        if (comboBox.getModel().getSize() > 0) {
            selectedIndex = comboBox.getSelectedIndex();
        }
        stringToWrite.append(String.valueOf(selectedIndex)).append("\n");
        for (Path source : pathList) {
            stringToWrite.append(source.toString()).append("\n");
        }        
        Path fileDest = Paths.get(homeDir, fileName);
        try {
            FileUtilities.writeStringToFile(fileDest, stringToWrite, false);
        } catch (IOException ex) {
            JOptionPane.showMessageDialog(this, "Problem saving paths:  " + ex.getMessage(), 
                    "Issue Saving Paths", JOptionPane.ERROR_MESSAGE);
            ex.printStackTrace();
        }
    }
    
    /*-----------------------------------------*/
    
    private void moveImage() {
        //Get the file source
        Path sourceFile = filesList.get(fileIndex);
        //Get the move to location
        String moveTo = (String) jComboBoxMoveToDestination.getSelectedItem();
        Path moveToPathAndFile = Paths.get(moveTo);
        if (jCheckBoxAutoCreateDirs.isSelected()) {
            long lastModified = sourceFile.toFile().lastModified();
            LocalDateTime fileDateTime = LocalDateTime.ofInstant(Instant.ofEpochMilli(lastModified), ZoneId.systemDefault());
            String year = String.valueOf(fileDateTime.getYear());
            String month = String.valueOf(fileDateTime.getMonthValue());
            if (month.length() < 2) {
                month = "0" + month;
            }
            moveToPathAndFile = Paths.get(moveTo, year, month);
        }
        try {
            String fileExtension = jLabelFilenameExtension.getText();
            String fileName = jTextFieldFilename.getText();
            if (fileName.isEmpty()) throw new Exception("Filename is required");
            fileName = fileName + "." + fileExtension;
            moveToPathAndFile = moveToPathAndFile.resolve(fileName);
            boolean success = FileUtilities.copyFile(sourceFile, moveToPathAndFile);
            if (!success) throw new Exception("Are you sure the destination and source are different?");
            Files.delete(sourceFile);
            int originalIndex = fileIndex;
            getSourceFiles();
            fileIndex = originalIndex;
            if (originalIndex > filesList.size() - 1) {
                fileIndex = filesList.size() - 1;
            }
            setImage();
        } catch (Exception ex) {
            JOptionPane.showMessageDialog(this, "Problem moving file:  " + ex.getMessage(), 
                    "Issue Moving File", JOptionPane.ERROR_MESSAGE);
            ex.printStackTrace();
        }
    }

    private void deleteImage() {
        //Get the file source
        Path sourceFile = filesList.get(fileIndex);
        //Get the delete to location
        String deleteTo = (String) jComboBoxDeleteToDestination.getSelectedItem();
        Path deleteToPathAndFile = Paths.get(deleteTo);
        try {
            deleteToPathAndFile = deleteToPathAndFile.resolve(sourceFile.getFileName());
            boolean success = FileUtilities.copyFile(sourceFile, deleteToPathAndFile);
            if (!success) throw new Exception("Are you sure the destination and source are different?");
            Files.delete(sourceFile);
            int originalIndex = fileIndex;
            getSourceFiles();
            fileIndex = originalIndex;
            if (originalIndex > filesList.size() - 1) {
                fileIndex = filesList.size() - 1;
            }
            setImage();
        } catch (Exception ex) {
            JOptionPane.showMessageDialog(this, "Problem deleting file:  " + ex.getMessage(), 
                    "Issue Deleting File", JOptionPane.ERROR_MESSAGE);
            ex.printStackTrace();
        }
    }

}
